name: haskell-nix-ubuntu-lucid
version: 0.0.8
inherits: bennofs/haskell-nix-ubuntu-lucid@0.0.6
type: main
platform: ubuntu@10.04
description: The nix package manager preconfigured to build Haskell applications for ubuntu 10.04.
keywords:
  - haskell
  - 32bit
  - ghc
  - cabal
script: |
  # Update nix channels
  nix-channel --update

  setsid --wait $(type -p bash) -c 'echo setsid works'
  type -p bash

  # Populate the nix store with prebuild haskell packages
  setsid --wait $(type -p bash) --norc --noprofile -c 'trap "exit 0" SIGTERM SIGINT; cmdpid=$BASHPID; (sleep 600; kill -TERM -- -$cmdpid) & nix-build --no-out-link $WERCKER_SOURCE_DIR/packages.niSIx' || echo "--- Please deploy again, build not yet complete due to time limit."
